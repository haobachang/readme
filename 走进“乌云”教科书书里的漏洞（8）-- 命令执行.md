# 0x01 漏洞解析
<font style="color:rgba(0, 0, 0, 0.85) !important;">命令执行漏洞是指攻击者通过构造特殊输入，使应用程序执行未授权的系统命令，从而控制服务器或获取敏感信息的严重安全漏洞。该漏洞多存在于需要调用系统命令的功能中（如文件处理、系统监控、网络操作等）。</font>

<font style="color:rgba(0, 0, 0, 0.85) !important;">具体表现与危害：</font>

+ **<font style="color:rgb(0, 0, 0) !important;">漏洞成因</font>**<font style="color:rgba(0, 0, 0, 0.85) !important;">：应用程序未对用户输入进行严格过滤和验证，直接将用户可控数据拼接进系统命令并执行。例如，在需要执行</font>`<font style="color:rgb(0, 0, 0);">ping</font>`<font style="color:rgba(0, 0, 0, 0.85) !important;">命令的功能中，若直接使用</font>`<font style="color:rgb(0, 0, 0);">exec("ping " + userInput)</font>`<font style="color:rgba(0, 0, 0, 0.85) !important;">，攻击者可输入</font>`<font style="color:rgb(0, 0, 0);">127.0.0.1; rm -rf /</font>`<font style="color:rgba(0, 0, 0, 0.85) !important;">，导致恶意命令被执行。</font>
+ **<font style="color:rgb(0, 0, 0) !important;">常见攻击方式</font>**<font style="color:rgba(0, 0, 0, 0.85) !important;">：通过分号</font>`<font style="color:rgb(0, 0, 0);">;</font>`<font style="color:rgba(0, 0, 0, 0.85) !important;">、管道符</font>`<font style="color:rgb(0, 0, 0);">|</font>`<font style="color:rgba(0, 0, 0, 0.85) !important;">、与符号</font>`<font style="color:rgb(0, 0, 0);">&</font>`<font style="color:rgba(0, 0, 0, 0.85) !important;">等命令分隔符拼接恶意命令；利用命令替换（如</font>`<font style="color:rgb(0, 0, 0);">$(恶意命令)</font>`<font style="color:rgba(0, 0, 0, 0.85) !important;">或</font>`<font style="color:rgb(0, 0, 0);">`恶意命令`</font>`<font style="color:rgba(0, 0, 0, 0.85) !important;">）注入代码；通过重定向符（</font>`<font style="color:rgb(0, 0, 0);">></font>`<font style="color:rgba(0, 0, 0, 0.85) !important;">、</font>`<font style="color:rgb(0, 0, 0);">>></font>`<font style="color:rgba(0, 0, 0, 0.85) !important;">）写入恶意文件等。</font>
+ **<font style="color:rgb(0, 0, 0) !important;">危害后果</font>**<font style="color:rgba(0, 0, 0, 0.85) !important;">：攻击者可执行任意系统命令，包括删除文件、查看敏感数据、创建管理员账户、植入后门程序等，最终可能完全控制服务器，导致数据泄露、服务中断甚至服务器被用于攻击其他系统。</font>

命令执行

  


# 0x02 漏洞环境
针对此漏洞，在[好靶场](http://www.loveli.com.cn:12531/)平台有搭建自创的同类型漏洞

靶场连接：[http://www.loveli.com.cn:12531/](http://www.loveli.com.cn:12531/)

![](https://cdn.nlark.com/yuque/0/2025/png/8420228/1755436500041-a7f0c828-85ea-4ac4-8e80-500591e9b850.png)

# 0x03 漏洞复现
访问目标靶场

![](https://cdn.nlark.com/yuque/0/2025/png/8420228/1755245443158-621d96c8-2f6d-411b-8356-a2c811d3e83a.png)

此处功能可通过输入ip执行ping命令，通过“|”等符号拼接可执行系统命令 例如此处 whoami

![](https://cdn.nlark.com/yuque/0/2025/png/8420228/1755245558052-132b6b04-1664-4d0a-a81a-ae775d45d507.png)

通过find 命令获取到flag文件位置

![](https://cdn.nlark.com/yuque/0/2025/png/8420228/1755245810830-602b4db4-4e04-475e-9539-f51aafad881b.png)

利用cat命令查看flag文件

![](https://cdn.nlark.com/yuque/0/2025/png/8420228/1755245853266-352306cc-7b89-413c-94ae-eb5e3a7e3d50.png)

# 0x04 漏洞修复方法
**<font style="color:rgb(0, 0, 0) !important;">严格输入验证</font>**

    - <font style="color:rgba(0, 0, 0, 0.85) !important;">仅允许白名单限制允许的输入格式</font>
    - <font style="color:rgba(0, 0, 0, 0.85) !important;">例如：仅允许 IP 地址格式的字符</font>

**<font style="color:rgb(0, 0, 0) !important;">安全执行命令</font>**

    - <font style="color:rgba(0, 0, 0, 0.85) !important;">使用参数化方式传递参数（命令与参数分离）</font>
    - <font style="color:rgba(0, 0, 0, 0.85) !important;">禁止使用字符串拼接构造命令</font>

**<font style="color:rgb(0, 0, 0) !important;">权限控制</font>**

    - <font style="color:rgba(0, 0, 0, 0.85) !important;">以最低权限运行应用程序</font>
    - <font style="color:rgba(0, 0, 0, 0.85) !important;">禁止使用 root / 管理员权限</font>

  






