# 0x01 漏洞解析
#### <font style="color:rgb(0, 0, 0);">1. 漏洞原理</font>
<font style="color:rgba(0, 0, 0, 0.85) !important;">“验证码修改返回包绕过” 是一种针对验证码验证机制的攻击手段，核心原理是攻击者通过拦截、篡改服务器返回的</font>**<font style="color:rgb(0, 0, 0) !important;">验证码验证结果数据包</font>**<font style="color:rgba(0, 0, 0, 0.85) !important;">，绕过验证码的有效性校验。</font>

<font style="color:rgba(0, 0, 0, 0.85) !important;">而该漏洞的根源在于：</font>**<font style="color:rgb(0, 0, 0) !important;">服务器未对 “后续业务请求” 与 “验证码验证结果” 进行二次绑定校验</font>**<font style="color:rgba(0, 0, 0, 0.85) !important;">，仅依赖客户端接收的 “验证结果响应包” 判断是否允许继续操作。攻击者可通过抓包工具（如 Burp Suite）拦截服务器返回的 “验证失败” 响应包，将其篡改为 “验证成功”，客户端会误认为验证码已通过，从而允许攻击者继续执行后续操作（如暴力破解密码、批量注册等）。</font>

#### <font style="color:rgb(0, 0, 0);">2. 攻击场景</font>
+ **<font style="color:rgb(0, 0, 0) !important;">登录场景</font>**<font style="color:rgba(0, 0, 0, 0.85) !important;">：用户输入账号密码 + 错误验证码，服务器返回 “验证码错误” 的响应包，攻击者篡改响应为 “验证成功”，客户端直接提交登录请求，服务器未二次验证验证码，导致错误验证码被绕过。</font>
+ **<font style="color:rgb(0, 0, 0) !important;">注册场景</font>**<font style="color:rgba(0, 0, 0, 0.85) !important;">：攻击者使用注册机批量生成账号，拦截服务器返回的 “验证码无效” 响应并篡改，绕过验证后批量注册垃圾账号。</font>
+ **<font style="color:rgb(0, 0, 0) !important;">密码重置场景</font>**<font style="color:rgba(0, 0, 0, 0.85) !important;">：攻击者通过篡改验证码验证结果，绕过人机校验，非法发起密码重置请求。</font>

#### <font style="color:rgb(0, 0, 0);">3. 危害</font>
+ <font style="color:rgba(0, 0, 0, 0.85) !important;">导致验证码失去 “区分人机” 的核心作用，自动化攻击（如暴力破解、注册机、刷票）得以实施；</font>
+ <font style="color:rgba(0, 0, 0, 0.85) !important;">可能引发账号被盗、垃圾账号泛滥、业务数据被篡改等安全问题，破坏系统正常运营。</font>

  


# 0x02 漏洞环境
针对此漏洞，在[好靶场](http://www.loveli.com.cn:12531/)平台有搭建自创的同类型漏洞

靶场连接：[http://www.loveli.com.cn:12531/](http://www.loveli.com.cn:12531/)

![](https://cdn.nlark.com/yuque/0/2025/png/8420228/1755437224683-532d4308-db1a-4b7f-ac98-f8b59ecd68a3.png)

# 0x03 漏洞复现
访问目标网站，尝试登录提示均为用户或密码错误无法获取有效信息

![](https://cdn.nlark.com/yuque/0/2025/png/8420228/1755246785971-1bc0ba98-ad49-417b-9173-52e33744c963.png)

点击忘记密码 随便输入用户名点击发送验证码无响应

![](https://cdn.nlark.com/yuque/0/2025/png/8420228/1755246827834-c38308f1-c0a2-4866-9ad9-86600e3bf274.png)

按下`F12`键打开浏览器开发者工具，切换至 “网络（Network）” 面板，查看网络请求

输入用户名时会检查用户是否存在

![](https://cdn.nlark.com/yuque/0/2025/png/8420228/1755246962784-e6ac5f5d-ac16-42ad-a71f-93ec460c19ad.png)

乱输入邮箱验证码后点击验证会 提示 找不到该用户信息

![](https://cdn.nlark.com/yuque/0/2025/png/8420228/1755247039363-79737077-3f11-4806-842a-bb41ce57acc2.png)

打开 Burp Suite、Fiddler 等抓包工具，确保代理设置正确（浏览器代理指向抓包工具端口，例：`127.0.0.1:8080`），拦截目标网站的 HTTP/HTTPS 请求。  

再次点击验证，抓取请求包

![](https://cdn.nlark.com/yuque/0/2025/png/8420228/1755247153010-9e591bc9-cb3e-4333-84c4-32eabcab2ba4.png)

使用Burp Suite的爆破模块

![](https://cdn.nlark.com/yuque/0/2025/png/8420228/1755247323086-f4cdd1d8-6ec0-4d74-b34e-30c5380f8453.png)

通过爆破用户名爆破出用户 admin

![](https://cdn.nlark.com/yuque/0/2025/png/8420228/1755247365067-4c6e7329-ac37-4da3-b436-d7526649305b.png)

继续开启Burp Suite抓包 输入用户名admin 乱输入验证码 通过Burp Suite 修改响应中的success参数为 “ture”绕过短信验证。

![](https://cdn.nlark.com/yuque/0/2025/png/8420228/1755247560919-b97f9587-8906-4e70-95d1-c6f5fd2e2a84.png)

![](https://cdn.nlark.com/yuque/0/2025/png/8420228/1755247579425-5512aef2-572e-400a-9d1d-a5bea370512b.png)

输入新密码成功修改admin的密码

![](https://cdn.nlark.com/yuque/0/2025/png/8420228/1755247645294-4c04a291-3217-4c42-be58-b2bf19fe8587.png)

回到登录界面尝试登录 获取到flag

![](https://cdn.nlark.com/yuque/0/2025/png/8420228/1755247684165-b9740bfa-8d34-4e45-bb6e-b01ac612f5c1.png)

# 0x04 漏洞修复方法
**<font style="color:rgb(0, 0, 0) !important;">服务器端必须对验证码进行 “二次校验”</font>**<font style="color:rgba(0, 0, 0, 0.85) !important;">，即后续业务请求（如登录提交、注册提交）必须再次验证验证码的有效性，不依赖客户端接收的 “验证结果响应包”。</font>

  






